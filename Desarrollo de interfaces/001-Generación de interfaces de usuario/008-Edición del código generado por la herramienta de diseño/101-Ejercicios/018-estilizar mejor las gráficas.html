<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grafica</title>
   
</head>
<body>
    <div class="grafica1"></div>
    <div class="grafica2"></div>
    <div class="grafica3"></div>
    <div class="grafica4"></div>
    <script>
        let datos1 = [
             {
                "Etiqueta":"España",
                "Valor":56
                },
                 {
                "Etiqueta":"Francia",
                "Valor":78  
                },
                 {
                "Etiqueta":"Alemania",
                "Valor":76
                },
                 {
                "Etiqueta":"Austria",
                "Valor":87
                },
                 {
                "Etiqueta":"Italia",
                "Valor":98
                },
                
            ]
           let datos2 = [
               {
                   "Etiqueta": "Fútbol",
                   "Valor": 92
               },
               {
                   "Etiqueta": "Baloncesto",
                   "Valor": 75
               },
               {
                   "Etiqueta": "Tenis",
                   "Valor": 63
               },
               {
                   "Etiqueta": "Natación", 
                   "Valor": 58
               },
               {
                   "Etiqueta": "Ciclismo",
                   "Valor": 71
               }
           ]
           let datos3 = [
               {
                   "Etiqueta": "Rojo",
                   "Valor": 81
               },
               {
                   "Etiqueta": "Azul",
                   "Valor": 66
               },
               {
                   "Etiqueta": "Verde", 
                   "Valor": 59
               },
               {
                   "Etiqueta": "Amarillo",
                   "Valor": 72
               },
               {
                   "Etiqueta": "Morado",
                   "Valor": 48
               }
           ]
           let datos4 = [
               {
                   "Etiqueta": "Manzana",
                   "Valor": 45
               },
               {
                   "Etiqueta": "Plátano", 
                   "Valor": 67
               },
               {
                   "Etiqueta": "Naranja",
                   "Valor": 52
               },
               {
                   "Etiqueta": "Uva",
                   "Valor": 78
               },
               {
                   "Etiqueta": "Fresa",
                   "Valor": 89
               }
            ]
     function getRandomHexColor(){
      return "#" + Math.floor(Math.random()* 16777215).toString(16).padStart(6,"0");
     }
     function randomLightnessVariation(hex, min = 0.7, max = 1.3) {
        // Convert hex → RGB
        let r = parseInt(hex.slice(1, 3), 16) / 255;
        let g = parseInt(hex.slice(3, 5), 16) / 255;
        let b = parseInt(hex.slice(5, 7), 16) / 255;

        // Find min/max for lightness and chroma
        let maxC = Math.max(r, g, b), minC = Math.min(r, g, b);
        let l = (maxC + minC) / 2; // lightness
        let s, h;
        if (maxC === minC) {
          s = h = 0;
        } else {
          let d = maxC - minC;
          s = l > 0.5 ? d / (2 - maxC - minC) : d / (maxC + minC);
          switch (maxC) {
            case r: h = (g - b) / d + (g < b ? 6 : 0); break;
            case g: h = (b - r) / d + 2; break;
            case b: h = (r - g) / d + 4; break;
          }
          h /= 6;
        }

        // Random variation on lightness
        let variation = l * (min + Math.random() * (max - min));
        if (variation > 1) variation = 1;
        if (variation < 0) variation = 0;

        // Convert HSL → RGB
        function hue2rgb(p, q, t) {
          if (t < 0) t += 1;
          if (t > 1) t -= 1;
          if (t < 1/6) return p + (q - p) * 6 * t;
          if (t < 1/2) return q;
          if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
          return p;
        }

        let q = variation < 0.5 ? variation * (1 + s) : variation + s - variation * s;
        let p = 2 * variation - q;
        r = hue2rgb(p, q, h + 1/3);
        g = hue2rgb(p, q, h);
        b = hue2rgb(p, q, h - 1/3);

        // Back to hex
        return "#" + 
          Math.round(r * 255).toString(16).padStart(2, "0") +
          Math.round(g * 255).toString(16).padStart(2, "0") +
          Math.round(b * 255).toString(16).padStart(2, "0");
      }

     function jdgraficatarta(selector,datos1,color){
      let suma= 0;
      for(let i=0; i<datos1.length;i++){
       suma += datos1[i].Valor
      }
      console.log("La suma es:",suma)
      let cursor = 0
      let cadena = ""
      console.log(datos1)
     for(let i = 0; i<datos1.length;i++){
       inicio = cursor*100+"%"
       cursor += (datos1[i].Valor)/suma
       final = cursor*100+"%"
       cadena += randomLightnessVariation(color)+" "+inicio+" "+final+","
      }
      console.log(cadena)
      cadena = cadena.slice(0, -1);
      let grafica = document.querySelector(selector);
      grafica.style.position = "relative";
      grafica.style.width = "240px";
      grafica.style.aspectRatio = "1";
      grafica.style.borderRadius = "50%";
      grafica.style.background = 
        `conic-gradient(`+ cadena +`)`;
      }
     jdgraficatarta(".grafica1",datos1,"#008080")
     jdgraficatarta(".grafica2",datos2,"FF0000")
     jdgraficatarta(".grafica3",datos3,"00FF00")
     jdgraficatarta(".grafica4",datos4,"0000ff")
    </script>
</body>
</html>